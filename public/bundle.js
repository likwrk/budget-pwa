var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function d(){return l(" ")}function p(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function m(t,e){e=""+e,t.data!==e&&(t.data=e)}let y;function f(t){y=t}const h=[],g=Promise.resolve();let $=!1;const v=[],b=[],w=[];function D(t){b.push(t)}function S(){const t=new Set;do{for(;h.length;){const t=h.shift();f(t),x(t.$$)}for(;v.length;)v.shift()();for(;b.length;){const e=b.pop();t.has(e)||(e(),t.add(e))}}while(h.length);for(;w.length;)w.pop()();$=!1}function x(t){t.fragment&&(t.update(t.dirty),o(t.before_render),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_render.forEach(D))}let N;function O(){N={remaining:0,callbacks:[]}}function T(){N.remaining||o(N.callbacks)}function B(t){N.callbacks.push(t)}function k(t,n,r){const{fragment:a,on_mount:i,on_destroy:c,after_render:u}=t.$$;a.m(n,r),D(()=>{const n=i.map(e).filter(s);c?c.push(...n):o(n),t.$$.on_mount=[]}),u.forEach(D)}function I(t,e){t.$$.dirty||(h.push(t),$||($=!0,g.then(S)),t.$$.dirty=n()),t.$$.dirty[e]=!0}function H(e,s,r,a,i,c){const u=y;f(e);const l=s.props||{},d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:null};let p=!1;d.ctx=r?r(e,l,(t,n)=>{d.ctx&&i(d.ctx[t],d.ctx[t]=n)&&(d.bound[t]&&d.bound[t](n),p&&I(e,t))}):l,d.update(),p=!0,o(d.before_render),d.fragment=a(d.ctx),s.target&&(s.hydrate?d.fragment.l(function(t){return Array.from(t.childNodes)}(s.target)):d.fragment.c(),s.intro&&e.$$.fragment.i&&e.$$.fragment.i(),k(e,s.target,s.anchor),S()),f(u)}class _{$destroy(){var e,n;n=!0,(e=this).$$&&(o(e.$$.on_destroy),e.$$.fragment.d(n),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={}),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Nov","Dec"];function M(t){const e=t.getUTCFullYear(),n=t.getUTCMonth()+1,o=t.getUTCDate();return`${e}-${n<10?"0"+n:n}-${o<10?"0"+o:o}`}function A(t){return`${C[t.getUTCMonth()]} ${t.getUTCDate()}`}function J(t){return`${M(t)} ${function(t){const e=t.getUTCHours()+1,n=t.getUTCDate();return`${e<10?"0"+e:e}:${n<10?"0"+n:n}`}(t)}`}function F(e){var n,o,s,r,l,m,y,f,h,g,$;return{c(){n=u("form"),(o=u("label")).textContent="Date to:",s=d(),r=u("input"),l=d(),(m=u("label")).textContent="Budget:",y=d(),f=u("input"),g=d(),($=u("button")).textContent="Save",o.htmlFor="end",p(r,"type","date"),r.min=e.minDate,r.value=e.dateString,r.id="end",r.required=!0,m.htmlFor="budget",p(f,"type","number"),f.value=h=e.options.budget,f.id="budget",f.required=!0,n.dataset.action="save-options"},m(t,e){i(t,n,e),a(n,o),a(n,s),a(n,r),a(n,l),a(n,m),a(n,y),a(n,f),a(n,g),a(n,$)},p(t,e){t.minDate&&(r.min=e.minDate),t.dateString&&(r.value=e.dateString),t.options&&h!==(h=e.options.budget)&&(f.value=h)},i:t,o:t,d(t){t&&c(n)}}}function P(t,e,n){let{options:o}=e,s="",r="";return t.$set=t=>{"options"in t&&n("options",o=t.options)},t.$$.update=(t={options:1})=>{t.options&&(n("dateString",s=M(new Date(o.end))),n("minDate",r=M(new Date)))},{options:o,dateString:s,minDate:r}}class U extends _{constructor(t){super(),H(this,t,P,F,r,["options"])}}function E(t,e,n){const o=Object.create(t);return o.item=e[n],o}function L(t){var e,n,o,s,r,p,y,f,h,g,$,v=J(new Date(t.item.timestamp)),b=t.item.sum,w=t.item.category;return{c(){e=u("li"),n=l(v),o=d(),s=l(b),r=d(),p=l(w),y=d(),f=u("button"),h=l("Remove"),$=d(),f.type="button",f.dataset.action="remove-item",f.dataset.timestamp=g=t.item.timestamp},m(t,c){i(t,e,c),a(e,n),a(e,o),a(e,s),a(e,r),a(e,p),a(e,y),a(e,f),a(f,h),a(e,$)},p(t,e){t.historyItems&&v!==(v=J(new Date(e.item.timestamp)))&&m(n,v),t.historyItems&&b!==(b=e.item.sum)&&m(s,b),t.historyItems&&w!==(w=e.item.category)&&m(p,w),t.historyItems&&g!==(g=e.item.timestamp)&&(f.dataset.timestamp=g)},d(t){t&&c(e)}}}function j(e){for(var n,o=e.historyItems,s=[],r=0;r<o.length;r+=1)s[r]=L(E(e,o,r));return{c(){n=u("ul");for(var t=0;t<s.length;t+=1)s[t].c()},m(t,e){i(t,n,e);for(var o=0;o<s.length;o+=1)s[o].m(n,null)},p(t,e){if(t.historyItems||t.formatDateTime){o=e.historyItems;for(var r=0;r<o.length;r+=1){const a=E(e,o,r);s[r]?s[r].p(t,a):(s[r]=L(a),s[r].c(),s[r].m(n,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}},i:t,o:t,d(t){t&&c(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(s,t)}}}function q(t,e,n){let o,{history:s}=e;return t.$set=t=>{"history"in t&&n("history",s=t.history)},t.$$.update=(t={history:1})=>{t.history&&n("historyItems",o=s.reverse())},{history:s,historyItems:o}}class W extends _{constructor(t){super(),H(this,t,q,j,r,["history"])}}function R(e){var n;return{c(){(n=u("form")).innerHTML='<input placeholder="Sum" name="sum" type="number" value="" required class="svelte-h5p8ml">\n\t\t\t  <input placeholder="Category" name="category" type="text" value="" class="svelte-h5p8ml">\n\t\t\t  <button class="svelte-h5p8ml">Add</button>',n.dataset.action="add-item"},m(t,e){i(t,n,e)},p:t,i:t,o:t,d(t){t&&c(n)}}}class Y extends _{constructor(t){super(),H(this,t,null,R,r,[])}}function z(t){var e,n=new U({props:{options:t.options}});return{c(){n.$$.fragment.c()},m(t,o){k(n,t,o),e=!0},p(t,e){var o={};t.options&&(o.options=e.options),n.$set(o)},i(t){e||(n.$$.fragment.i(t),e=!0)},o(t){n.$$.fragment.o(t),e=!1},d(t){n.$destroy(t)}}}function G(t){var e,n=new W({props:{history:t.history}});return{c(){n.$$.fragment.c()},m(t,o){k(n,t,o),e=!0},p(t,e){var o={};t.history&&(o.history=e.history),n.$set(o)},i(t){e||(n.$$.fragment.i(t),e=!0)},o(t){n.$$.fragment.o(t),e=!1},d(t){n.$destroy(t)}}}function K(t){var e,n,o,s,r,p,y,f,h,g,$,v,b,w,D,S,x,N,I,H,_,C,M,A,J,F,P,U,E,L,j,q,W,R,K,Q,V,X,Z,tt=t.spentDays+1,et=t.options.budget,nt=new Y({}),ot=t.showOptions&&z(t),st=t.showHistory&&G(t);return{c(){e=u("main"),n=u("div"),o=u("p"),s=l(t.start),r=l(" - "),p=l(t.end),y=d(),f=u("p"),h=l("Day "),g=l(tt),$=l(" of "),v=l(t.days),b=d(),w=u("div"),D=u("div"),S=d(),x=u("div"),N=u("p"),I=l("Per day: "),H=l(t.perDay),_=d(),C=u("p"),M=l("Spent: "),A=l(t.spent),J=l(" of "),F=l(et),P=d(),U=u("div"),E=u("div"),L=d(),j=u("h2"),q=l("Budget for today: "),W=l(t.todayBudget),R=d(),nt.$$.fragment.c(),K=d(),(Q=u("div")).innerHTML='<button type="button" data-action="toggle-options">Options</button>\n\t\t\t\t\t<button type="button" data-action="toggle-history">History</button>',V=d(),ot&&ot.c(),X=d(),st&&st.c(),n.className="flex-row svelte-1vfen53",D.className="bar svelte-1vfen53",D.style.cssText=t.daysBarStyle,w.className="bar-container svelte-1vfen53",x.className="flex-row svelte-1vfen53",E.className="bar svelte-1vfen53",E.style.cssText=t.moneyBarStyle,U.className="bar-container svelte-1vfen53",Q.className="flex-row svelte-1vfen53",e.className="svelte-1vfen53"},m(t,c){i(t,e,c),a(e,n),a(n,o),a(o,s),a(o,r),a(o,p),a(n,y),a(n,f),a(f,h),a(f,g),a(f,$),a(f,v),a(e,b),a(e,w),a(w,D),a(e,S),a(e,x),a(x,N),a(N,I),a(N,H),a(x,_),a(x,C),a(C,M),a(C,A),a(C,J),a(C,F),a(e,P),a(e,U),a(U,E),a(e,L),a(e,j),a(j,q),a(j,W),a(e,R),k(nt,e,null),a(e,K),a(e,Q),a(e,V),ot&&ot.m(e,null),a(e,X),st&&st.m(e,null),Z=!0},p(t,n){Z&&!t.start||m(s,n.start),Z&&!t.end||m(p,n.end),Z&&!t.spentDays||tt===(tt=n.spentDays+1)||m(g,tt),Z&&!t.days||m(v,n.days),Z&&!t.daysBarStyle||(D.style.cssText=n.daysBarStyle),Z&&!t.perDay||m(H,n.perDay),Z&&!t.spent||m(A,n.spent),Z&&!t.options||et===(et=n.options.budget)||m(F,et),Z&&!t.moneyBarStyle||(E.style.cssText=n.moneyBarStyle),Z&&!t.todayBudget||m(W,n.todayBudget),n.showOptions?ot?(ot.p(t,n),ot.i(1)):((ot=z(n)).c(),ot.i(1),ot.m(e,X)):ot&&(O(),B(()=>{ot.d(1),ot=null}),ot.o(1),T()),n.showHistory?st?(st.p(t,n),st.i(1)):((st=G(n)).c(),st.i(1),st.m(e,null)):st&&(O(),B(()=>{st.d(1),st=null}),st.o(1),T())},i(t){Z||(nt.$$.fragment.i(t),ot&&ot.i(),st&&st.i(),Z=!0)},o(t){nt.$$.fragment.o(t),ot&&ot.o(),st&&st.o(),Z=!1},d(t){t&&c(e),nt.$destroy(),ot&&ot.d(),st&&st.d()}}}function Q(t,e,n){let o,s,r,a,i,c,u,l,d,p,{options:m,history:y,showOptions:f,showHistory:h}=e;return t.$set=t=>{"options"in t&&n("options",m=t.options),"history"in t&&n("history",y=t.history),"showOptions"in t&&n("showOptions",f=t.showOptions),"showHistory"in t&&n("showHistory",h=t.showHistory)},t.$$.update=(t={options:1,days:1,history:1,spentDays:1,perDay:1,spent:1,maxSpentForToday:1})=>{t.options&&n("start",o=A(new Date(M(new Date(m.start))))),t.options&&n("end",s=A(new Date(M(new Date(m.end))))),t.options&&n("days",r=Math.floor((m.end-m.start)/864e5)),t.options&&n("spentDays",a=Math.ceil((new Date(M(new Date(M(new Date)))).getTime()-new Date(m.start).getTime())/864e5)),(t.options||t.days)&&n("perDay",i=Math.round(m.budget/r)),t.history&&n("spent",c=y.reduce((t,e)=>t+e.sum,0)),(t.spentDays||t.perDay)&&n("maxSpentForToday",u=a*i),(t.perDay||t.spent||t.maxSpentForToday)&&n("todayBudget",l=i-(c-u)),(t.spentDays||t.days)&&n("daysBarStyle",d=`width: ${a/r*100}%`),(t.spent||t.options)&&n("moneyBarStyle",p=`width: ${c/m.budget*100}%`)},{options:m,history:y,showOptions:f,showHistory:h,start:o,end:s,days:r,spentDays:a,perDay:i,spent:c,todayBudget:l,daysBarStyle:d,moneyBarStyle:p}}const V="a3ebe359-db8c-4e82-b340-99d5ff6c0995",X=`history-${V}`,Z=`options-${V}`;function tt(){return{budget:0,end:Date.now(),start:Date.now(),active:!1}}function et(t){return new Promise(e=>{localStorage.setItem(Z,JSON.stringify(t)),e(t)})}function nt(){return new Promise(t=>{let e;try{e=JSON.parse(localStorage.getItem(X))||[]}catch(t){e=[]}t(e)})}let ot=!1,st=!1;const rt=new class extends _{constructor(t){super(),H(this,t,Q,K,r,["options","history","showOptions","showHistory"])}}({target:document.body,props:{history:[],options:tt(),showOptions:ot,showHistory:st}});return document.body.addEventListener("click",t=>{if("BUTTON"!==t.target.nodeName)return;const e=t.target.getAttribute("data-action");if(e)switch(e){case"remove-item":!async function(t){const e=Number(t.getAttribute("data-timestamp"));if(isNaN(e))return;const n=await function(t){return nt().then(e=>{const n=e.filter(e=>e.timestamp!==t);return localStorage.setItem(X,JSON.stringify(n)),n})}(e);rt.$set({history:n})}(t.target);break;case"toggle-options":ot=!ot,rt.$set({showOptions:ot});break;case"toggle-history":st=!st,rt.$set({showHistory:st})}}),document.body.addEventListener("submit",t=>{if("FORM"!==t.target.nodeName)return;const e=t.target.getAttribute("data-action");if(e)switch(t.preventDefault(),e){case"save-options":!async function(t){const e=new Date(t.end.value).getTime(),n=Date.now()<e,o=Number(t.budget.value),[s,r]=await Promise.all([et({end:e,active:n,budget:o,start:Date.now()}),new Promise(t=>{localStorage.setItem(X,JSON.stringify([])),t([])})]);ot=!1,rt.$set({options:s,history:r,showOptions:ot})}(t.target);break;case"add-item":!async function(t){const e=Number(t.sum.value),n=t.category.value||"",o=await(s={sum:e,category:n,timestamp:Date.now()},nt().then(t=>(t.push(s),localStorage.setItem(X,JSON.stringify(t)),t)));var s;t.reset(),rt.$set({history:o})}(t.target)}}),async function(){const[t,e]=await Promise.all([new Promise(t=>{let e;try{e=JSON.parse(localStorage.getItem(Z))||tt()}catch(t){e=tt()}t(e)}),nt()]);rt.$set({options:t,history:e})}(),window.addEventListener("load",function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js",{scope:"/budget-pwa/public/"}).then(()=>{console.log("Service Worker registered successfully.")}).catch(t=>{console.log("Service Worker registration failed:",t)})}),rt}();
//# sourceMappingURL=bundle.js.map
