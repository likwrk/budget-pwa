var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function s(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function d(){return l(" ")}function p(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function m(t,e){e=""+e,t.data!==e&&(t.data=e)}let y;function f(t){y=t}const h=[],g=Promise.resolve();let $=!1;const b=[],v=[],w=[];function D(t){v.push(t)}function x(){const t=new Set;do{for(;h.length;){const t=h.shift();f(t),S(t.$$)}for(;b.length;)b.shift()();for(;v.length;){const e=v.pop();t.has(e)||(e(),t.add(e))}}while(h.length);for(;w.length;)w.pop()();$=!1}function S(t){t.fragment&&(t.update(t.dirty),o(t.before_render),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_render.forEach(D))}let N;function O(){N={remaining:0,callbacks:[]}}function T(){N.remaining||o(N.callbacks)}function B(t){N.callbacks.push(t)}function H(t,n,r){const{fragment:a,on_mount:i,on_destroy:c,after_render:u}=t.$$;a.m(n,r),D(()=>{const n=i.map(e).filter(s);c?c.push(...n):o(n),t.$$.on_mount=[]}),u.forEach(D)}function k(t,e){t.$$.dirty||(h.push(t),$||($=!0,g.then(x)),t.$$.dirty=n()),t.$$.dirty[e]=!0}function I(e,s,r,a,i,c){const u=y;f(e);const l=s.props||{},d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(u?u.$$.context:[]),callbacks:n(),dirty:null};let p=!1;d.ctx=r?r(e,l,(t,n)=>{d.ctx&&i(d.ctx[t],d.ctx[t]=n)&&(d.bound[t]&&d.bound[t](n),p&&k(e,t))}):l,d.update(),p=!0,o(d.before_render),d.fragment=a(d.ctx),s.target&&(s.hydrate?d.fragment.l(function(t){return Array.from(t.childNodes)}(s.target)):d.fragment.c(),s.intro&&e.$$.fragment.i&&e.$$.fragment.i(),H(e,s.target,s.anchor),x()),f(u)}class C{$destroy(){var e,n;n=!0,(e=this).$$&&(o(e.$$.on_destroy),e.$$.fragment.d(n),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={}),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const _=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Nov","Dec"];function M(t){const e=J(t),n=e.getUTCFullYear(),o=e.getUTCMonth()+1,s=e.getUTCDate();return`${n}-${o<10?"0"+o:o}-${s<10?"0"+s:s}`}function A(t){const e=J(t);return`${_[e.getUTCMonth()]} ${e.getUTCDate()}`}function J(t){const e="number"==typeof t?new Date(t):new Date(t.getTime());return e.setUTCHours(0,0,0,0),e}function U(t){if(t instanceof Date){const e=t;return e.setHours(0,0,0,0),e.getTime()}return t-t%864e5}function F(t){return`${A(t)} ${function(t){const e=t.getUTCHours()+1,n=t.getUTCDate();return`${e<10?"0"+e:e}:${n<10?"0"+n:n}`}(t)}`}function P(e){var n,o,s,r,l,m,y,f,h,g,$;return{c(){n=u("form"),(o=u("label")).textContent="Date to:",s=d(),r=u("input"),l=d(),(m=u("label")).textContent="Budget:",y=d(),f=u("input"),g=d(),($=u("button")).textContent="Save",o.htmlFor="end",p(r,"type","date"),r.min=e.minDate,r.value=e.dateString,r.id="end",r.required=!0,m.htmlFor="budget",p(f,"type","number"),f.value=h=e.options.budget,f.id="budget",f.required=!0,n.dataset.action="save-options"},m(t,e){i(t,n,e),a(n,o),a(n,s),a(n,r),a(n,l),a(n,m),a(n,y),a(n,f),a(n,g),a(n,$)},p(t,e){t.minDate&&(r.min=e.minDate),t.dateString&&(r.value=e.dateString),t.options&&h!==(h=e.options.budget)&&(f.value=h)},i:t,o:t,d(t){t&&c(n)}}}function E(t,e,n){let{options:o}=e,s="",r="";return t.$set=t=>{"options"in t&&n("options",o=t.options)},t.$$.update=(t={options:1})=>{t.options&&(n("dateString",s=M(new Date(o.end))),n("minDate",r=M(new Date)))},{options:o,dateString:s,minDate:r}}class L extends C{constructor(t){super(),I(this,t,E,P,r,["options"])}}function j(t,e,n){const o=Object.create(t);return o.item=e[n],o}function q(t){var e,n,o,s,r,p,y,f,h,g,$,b=F(new Date(t.item.timestamp)),v=t.item.sum,w=t.item.category;return{c(){e=u("li"),n=l(b),o=d(),s=l(v),r=d(),p=l(w),y=d(),f=u("button"),h=l("Remove"),$=d(),f.type="button",f.dataset.action="remove-item",f.dataset.timestamp=g=t.item.timestamp},m(t,c){i(t,e,c),a(e,n),a(e,o),a(e,s),a(e,r),a(e,p),a(e,y),a(e,f),a(f,h),a(e,$)},p(t,e){t.historyItems&&b!==(b=F(new Date(e.item.timestamp)))&&m(n,b),t.historyItems&&v!==(v=e.item.sum)&&m(s,v),t.historyItems&&w!==(w=e.item.category)&&m(p,w),t.historyItems&&g!==(g=e.item.timestamp)&&(f.dataset.timestamp=g)},d(t){t&&c(e)}}}function W(e){for(var n,o=e.historyItems,s=[],r=0;r<o.length;r+=1)s[r]=q(j(e,o,r));return{c(){n=u("ul");for(var t=0;t<s.length;t+=1)s[t].c()},m(t,e){i(t,n,e);for(var o=0;o<s.length;o+=1)s[o].m(n,null)},p(t,e){if(t.historyItems||t.formatDateTime){o=e.historyItems;for(var r=0;r<o.length;r+=1){const a=j(e,o,r);s[r]?s[r].p(t,a):(s[r]=q(a),s[r].c(),s[r].m(n,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}},i:t,o:t,d(t){t&&c(n),function(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}(s,t)}}}function R(t,e,n){let o,{history:s}=e;return t.$set=t=>{"history"in t&&n("history",s=t.history)},t.$$.update=(t={history:1})=>{t.history&&n("historyItems",o=s.reverse())},{history:s,historyItems:o}}class Y extends C{constructor(t){super(),I(this,t,R,W,r,["history"])}}function z(e){var n;return{c(){(n=u("form")).innerHTML='<input placeholder="Sum" name="sum" type="number" value="" required class="svelte-h5p8ml">\n\t\t\t  <input placeholder="Category" name="category" type="text" value="" class="svelte-h5p8ml">\n\t\t\t  <button class="svelte-h5p8ml">Add</button>',n.dataset.action="add-item"},m(t,e){i(t,n,e)},p:t,i:t,o:t,d(t){t&&c(n)}}}class G extends C{constructor(t){super(),I(this,t,null,z,r,[])}}function K(t){var e,n=new L({props:{options:t.options}});return{c(){n.$$.fragment.c()},m(t,o){H(n,t,o),e=!0},p(t,e){var o={};t.options&&(o.options=e.options),n.$set(o)},i(t){e||(n.$$.fragment.i(t),e=!0)},o(t){n.$$.fragment.o(t),e=!1},d(t){n.$destroy(t)}}}function Q(t){var e,n=new Y({props:{history:t.history}});return{c(){n.$$.fragment.c()},m(t,o){H(n,t,o),e=!0},p(t,e){var o={};t.history&&(o.history=e.history),n.$set(o)},i(t){e||(n.$$.fragment.i(t),e=!0)},o(t){n.$$.fragment.o(t),e=!1},d(t){n.$destroy(t)}}}function V(t){var e,n,o,s,r,p,y,f,h,g,$,b,v,w,D,x,S,N,k,I,C,_,M,A,J,U,F,P,E,L,j,q,W,R,Y,z,V,X,Z,tt=t.spentDays+1,et=t.options.budget,nt=new G({}),ot=t.showOptions&&K(t),st=t.showHistory&&Q(t);return{c(){e=u("main"),n=u("div"),o=u("p"),s=l(t.start),r=l(" - "),p=l(t.end),y=d(),f=u("p"),h=l("Day "),g=l(tt),$=l(" of "),b=l(t.days),v=d(),w=u("div"),D=u("div"),x=d(),S=u("div"),N=u("p"),k=l("Per day: "),I=l(t.perDay),C=d(),_=u("p"),M=l("Spent: "),A=l(t.spent),J=l(" of "),U=l(et),F=d(),P=u("div"),E=u("div"),L=d(),j=u("h2"),q=l("Budget for today: "),W=l(t.todayBudget),R=d(),nt.$$.fragment.c(),Y=d(),(z=u("div")).innerHTML='<button type="button" data-action="toggle-options">Options</button>\n\t\t\t\t\t<button type="button" data-action="toggle-history">History</button>',V=d(),ot&&ot.c(),X=d(),st&&st.c(),n.className="flex-row svelte-a5u60x",D.className="bar svelte-a5u60x",D.style.cssText=t.daysBarStyle,w.className="bar-container svelte-a5u60x",S.className="flex-row svelte-a5u60x",E.className="bar svelte-a5u60x",E.style.cssText=t.moneyBarStyle,P.className="bar-container svelte-a5u60x",z.className="flex-row svelte-a5u60x",e.className="svelte-a5u60x"},m(t,c){i(t,e,c),a(e,n),a(n,o),a(o,s),a(o,r),a(o,p),a(n,y),a(n,f),a(f,h),a(f,g),a(f,$),a(f,b),a(e,v),a(e,w),a(w,D),a(e,x),a(e,S),a(S,N),a(N,k),a(N,I),a(S,C),a(S,_),a(_,M),a(_,A),a(_,J),a(_,U),a(e,F),a(e,P),a(P,E),a(e,L),a(e,j),a(j,q),a(j,W),a(e,R),H(nt,e,null),a(e,Y),a(e,z),a(e,V),ot&&ot.m(e,null),a(e,X),st&&st.m(e,null),Z=!0},p(t,n){Z&&!t.start||m(s,n.start),Z&&!t.end||m(p,n.end),Z&&!t.spentDays||tt===(tt=n.spentDays+1)||m(g,tt),Z&&!t.days||m(b,n.days),Z&&!t.daysBarStyle||(D.style.cssText=n.daysBarStyle),Z&&!t.perDay||m(I,n.perDay),Z&&!t.spent||m(A,n.spent),Z&&!t.options||et===(et=n.options.budget)||m(U,et),Z&&!t.moneyBarStyle||(E.style.cssText=n.moneyBarStyle),Z&&!t.todayBudget||m(W,n.todayBudget),n.showOptions?ot?(ot.p(t,n),ot.i(1)):((ot=K(n)).c(),ot.i(1),ot.m(e,X)):ot&&(O(),B(()=>{ot.d(1),ot=null}),ot.o(1),T()),n.showHistory?st?(st.p(t,n),st.i(1)):((st=Q(n)).c(),st.i(1),st.m(e,null)):st&&(O(),B(()=>{st.d(1),st=null}),st.o(1),T())},i(t){Z||(nt.$$.fragment.i(t),ot&&ot.i(),st&&st.i(),Z=!0)},o(t){nt.$$.fragment.o(t),ot&&ot.o(),st&&st.o(),Z=!1},d(t){t&&c(e),nt.$destroy(),ot&&ot.d(),st&&st.d()}}}function X(t,e,n){let o,s,r,a,i,c,u,l,d,p,{options:m,history:y,showOptions:f,showHistory:h}=e;return t.$set=t=>{"options"in t&&n("options",m=t.options),"history"in t&&n("history",y=t.history),"showOptions"in t&&n("showOptions",f=t.showOptions),"showHistory"in t&&n("showHistory",h=t.showHistory)},t.$$.update=(t={options:1,days:1,history:1,spentDays:1,perDay:1,spent:1,maxSpentForToday:1})=>{t.options&&n("start",o=A(m.start)),t.options&&n("end",s=A(m.end)),t.options&&n("days",r=Math.floor((m.end-m.start)/864e5)),t.options&&n("spentDays",a=Math.ceil((U(Date.now())-U(m.start))/864e5)),(t.options||t.days)&&n("perDay",i=Math.round(m.budget/r)),t.history&&n("spent",c=y.reduce((t,e)=>t+e.sum,0)),(t.spentDays||t.perDay)&&n("maxSpentForToday",u=a*i),(t.perDay||t.spent||t.maxSpentForToday)&&n("todayBudget",l=i-(c-u)),(t.spentDays||t.days)&&n("daysBarStyle",d=`width: ${a/r*100}%`),(t.spent||t.options)&&n("moneyBarStyle",p=`width: ${c/m.budget*100}%`)},{options:m,history:y,showOptions:f,showHistory:h,start:o,end:s,days:r,spentDays:a,perDay:i,spent:c,todayBudget:l,daysBarStyle:d,moneyBarStyle:p}}const Z="a3ebe359-db8c-4e82-b340-99d5ff6c0995",tt=`history-${Z}`,et=`options-${Z}`;function nt(){return{budget:0,end:Date.now(),start:Date.now(),active:!1}}function ot(t){return new Promise(e=>{localStorage.setItem(et,JSON.stringify(t)),e(t)})}function st(){return new Promise(t=>{let e;try{e=JSON.parse(localStorage.getItem(tt))||[]}catch(t){e=[]}t(e)})}let rt=!1,at=!1;const it=new class extends C{constructor(t){super(),I(this,t,X,V,r,["options","history","showOptions","showHistory"])}}({target:document.body,props:{history:[],options:nt(),showOptions:rt,showHistory:at}});return document.body.addEventListener("click",t=>{if("BUTTON"!==t.target.nodeName)return;const e=t.target.getAttribute("data-action");if(e)switch(e){case"remove-item":!async function(t){const e=Number(t.getAttribute("data-timestamp"));if(isNaN(e))return;const n=await function(t){return st().then(e=>{const n=e.filter(e=>e.timestamp!==t);return localStorage.setItem(tt,JSON.stringify(n)),n})}(e);it.$set({history:n})}(t.target);break;case"toggle-options":rt=!rt,it.$set({showOptions:rt});break;case"toggle-history":at=!at,it.$set({showHistory:at})}}),document.body.addEventListener("submit",t=>{if("FORM"!==t.target.nodeName)return;const e=t.target.getAttribute("data-action");if(e)switch(t.preventDefault(),e){case"save-options":!async function(t){const e=U(new Date(t.end.value)),n=U(Date.now()),o=n<e,s=Number(t.budget.value),[r,a]=await Promise.all([ot({end:e,active:o,budget:s,start:n}),new Promise(t=>{localStorage.setItem(tt,JSON.stringify([])),t([])})]);rt=!1,it.$set({options:r,history:a,showOptions:rt})}(t.target);break;case"add-item":!async function(t){const e=Number(t.sum.value),n=t.category.value||"",o=await(s={sum:e,category:n,timestamp:U(Date.now())},st().then(t=>(t.push(s),localStorage.setItem(tt,JSON.stringify(t)),t)));var s;t.reset(),it.$set({history:o})}(t.target)}}),async function(){const[t,e]=await Promise.all([new Promise(t=>{let e;try{e=JSON.parse(localStorage.getItem(et))||nt()}catch(t){e=nt()}t(e)}),st()]);it.$set({options:t,history:e})}(),window.addEventListener("load",function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("service-worker.js",{scope:"/budget-pwa/public/"}).then(()=>{console.log("Service Worker registered successfully.")}).catch(t=>{console.log("Service Worker registration failed:",t)})}),it}();
//# sourceMappingURL=bundle.js.map
